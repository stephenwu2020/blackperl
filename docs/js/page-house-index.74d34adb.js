(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["page-house-index"],{"017c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7bff"),a=function(){function e(e,t){this.x=e,this.y=t,this.dragFromX=0,this.dragFromY=0,this.dragToX=0,this.dragToY=0,this.dragMoveX=0,this.dragMoveY=0}return e.prototype.getPos=function(){return{x:this.x,y:this.y}},e.prototype.dragStart=function(e,t){this.dragFromX=e,this.dragFromY=t},e.prototype.dragEnd=function(e,t){this.dragToX=e,this.dragToY=t},e.prototype.dragMove=function(){this.dragMoveX=this.dragToX-this.dragFromX,this.dragMoveY=this.dragToY-this.dragFromY,this.x+=this.dragMoveX,this.y+=this.dragMoveY},e.prototype.getMoved=function(){return{x:this.dragMoveX,y:this.dragMoveY}},e.prototype.directMove=function(e){this.x+=e.x,this.y+=e.y},e.prototype.getCanvasMidPos=function(e){return{x:e.canvas.width/2-this.x,y:e.canvas.height/2-this.y}},e.prototype.canvasPos2LandPos=function(e){return{x:e.x-this.x,y:e.y-this.y}},e.prototype.setOriginPos=function(e){this.x=e.x,this.y=e.y},e.landPos2GridPos=function(e){var t=Math.floor(e.y/o.MacroScene.HouseSize),n=Math.floor(e.x/o.MacroScene.HouseSize);return{r:t,c:n}},e.gridPos2LandPos=function(e,t){var n=t*o.MacroScene.HouseSize,a=e*o.MacroScene.HouseSize;return{x:n,y:a}},e.gridMiddle2LandPos=function(e,t){var n=t*o.MacroScene.HouseSize+o.MacroScene.HouseSize/2,a=e*o.MacroScene.HouseSize+o.MacroScene.HouseSize/2;return{x:n,y:a}},e}();t.LandCoordinate=a},"1c5f":function(e,t,n){},"2ff6":function(e,t,n){"use strict";n.r(t);var o=n("b02f"),a=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},"475f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("9ab4"),a=o.__importDefault(n("2b0e")),r=n("7bff"),i=o.__importDefault(n("8b9a"));t.default=a.default.extend({components:{Scene:i.default},data:function(){return{ok:!1,width:r.MacroScene.CanvasWidth,height:r.MacroScene.CanvasHeight,canvasElem:null}},created:function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){switch(e.label){case 0:return[4,this.$app.house.init()];case 1:return e.sent(),this.checkOK(),[2]}}))}))},mounted:function(){var e=this.$refs.canvas,t=e.getContext("2d");t&&(this.canvasElem={width:r.MacroScene.CanvasWidth,height:r.MacroScene.CanvasHeight,canvas:e,context:t},this.checkOK())},methods:{checkOK:function(){this.ok=this.$app.house.hasInit&&null!==this.canvasElem}}})},"4a4a":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},a=[];n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}))},"539b":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"house"},[n("canvas",{ref:"canvas",staticClass:"house-canvas",attrs:{width:e.width,height:e.height}}),e.ok?[n("scene",{attrs:{canvasElem:e.canvasElem}})]:e._e()],2)},a=[];n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}))},"6ea1":function(e,t,n){"use strict";n.r(t);var o=n("539b"),a=n("984e");for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n("7f35");var i=n("2877"),s=Object(i["a"])(a["default"],o["a"],o["b"],!1,null,"7db0c31a",null);t["default"]=s.exports},"7eff":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7bff");t.drawWrapper=function(e,t,n){e.save(),e.translate(t.x,t.y),e.beginPath(),n(e,t),e.closePath(),e.restore()},t.rectInCanvas=function(e,t,n,o){var a=t.x+n.x,r=t.y+n.y,i=a>=-o&&a<=e.canvas.width&&r>=-o&&r<=e.canvas.height;return i},t.drawImageMid=function(e,t,n,o){e.drawImage(n,t.x-o/2,t.y-o/2,o,o)},t.surround=function(e,t,n){for(var a=[],r=[],i=e-n;i<=e+n;i++)if(!(i<0||i>=o.MacroScene.RowNum))for(var s=t-n;s<=t+n;s++)s<0||s>=o.MacroScene.ColNum||(a.push(i),r.push(s));return{rows:a,cols:r}}},"7f35":function(e,t,n){"use strict";var o=n("1c5f"),a=n.n(o);a.a},"81d5":function(e,t,n){"use strict";var o=n("7b0b"),a=n("23cb"),r=n("50c4");e.exports=function(e){var t=o(this),n=r(t.length),i=arguments.length,s=a(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,d=void 0===c?n:a(c,n);while(d>s)t[s++]=e;return t}},"8b9a":function(e,t,n){"use strict";n.r(t);var o=n("4a4a"),a=n("2ff6");for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);var i=n("2877"),s=Object(i["a"])(a["default"],o["a"],o["b"],!1,null,null,null);t["default"]=s.exports},"984e":function(e,t,n){"use strict";n.r(t);var o=n("475f"),a=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},b02f:function(e,t,n){"use strict";n("cb29"),Object.defineProperty(t,"__esModule",{value:!0});var o=n("9ab4"),a=o.__importDefault(n("2b0e")),r=n("017c"),i=o.__importStar(n("7eff")),s=n("7bff"),c=n("fb64");t.default=a.default.extend({props:{canvasElem:{type:Object}},data:function(){return{landCoord:new r.LandCoordinate(0,0),land:new c.LandRender,draging:!1,clickFlag:!1,selectedGrid:null}},mounted:function(){this.draw(),this.canvasElem.canvas.addEventListener("mousedown",this.onMouseDown),this.canvasElem.canvas.addEventListener("mousemove",this.onMouseMove),this.canvasElem.canvas.addEventListener("mouseup",this.onMouseUp),this.canvasElem.canvas.addEventListener("mouseout",this.onMouseUp),window.addEventListener("keydown",this.onKeyDown)},methods:{draw:function(){this.clear(),this.drawLand(),this.drawSelectedGrid(),this.drawHouse()},clear:function(){this.canvasElem.context.clearRect(0,0,this.canvasElem.width,this.canvasElem.height)},drawLand:function(){var e=this,t=this.landCoord.getPos(),n=function(t,n){e.land.draw(t,n)};i.drawWrapper(this.canvasElem.context,t,n)},drawSelectedGrid:function(){var e=this;if(this.selectedGrid){var t=function(t,n){if(e.selectedGrid){var o={x:e.selectedGrid.c*s.MacroScene.HouseSize,y:e.selectedGrid.r*s.MacroScene.HouseSize};t.fillStyle="rgba(188,213,103, 0.5)",t.rect(o.x,o.y,s.MacroScene.HouseSize,s.MacroScene.HouseSize),t.fill()}},n=this.landCoord.getPos();i.drawWrapper(this.canvasElem.context,n,t)}},drawHouse:function(){var e=this,t=function(t,n){var o=r.LandCoordinate.gridMiddle2LandPos(0,0),a=e.$app.house.imageMgr.getImage("house1.png"),c=s.MacroScene.HouseImageSize;i.drawImageMid(e.canvasElem.context,o,a.obj,c)},n=this.landCoord.getPos();i.drawWrapper(this.canvasElem.context,n,t)},onClick:function(e){var t={x:e.offsetX,y:e.offsetY},n=this.landCoord.canvasPos2LandPos(t),o=r.LandCoordinate.landPos2GridPos(n);o.r<0||o.r>=s.MacroScene.RowNum||o.c<0||o.c>=s.MacroScene.ColNum?this.selectedGrid=null:this.selectedGrid=o,this.draw()},onMouseDown:function(e){var t=e.clientX,n=e.clientY;this.draging=!0,this.clickFlag=!0,this.landCoord.dragStart(t,n)},onMouseUp:function(e){this.draging=!1,this.clickFlag&&this.onClick(e)},onMouseMove:function(e){if(this.clickFlag=!1,this.draging){var t=e.clientX,n=e.clientY;this.landCoord.dragEnd(t,n),this.landCoord.dragMove(),this.draw(),this.landCoord.dragStart(t,n)}},onKeyDown:function(e){var t=10;switch(e.key){case"d":this.landCoord.directMove({x:t,y:0}),this.draw();break;case"a":this.landCoord.directMove({x:-t,y:0}),this.draw();break;case"w":this.landCoord.directMove({x:0,y:-t}),this.draw();break;case"s":this.landCoord.directMove({x:0,y:t}),this.draw();break}}}})},cb29:function(e,t,n){var o=n("23e7"),a=n("81d5"),r=n("44d2");o({target:"Array",proto:!0},{fill:a}),r("fill")},fb64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7bff"),a=function(){function e(){this.lineColor="black",this.lineWidth=.1}return e.prototype.draw=function(e,t){this.drawRows(e,t),this.drawCols(e,t)},e.prototype.drawRows=function(e,t){e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth;var n=0,a=0;e.lineWidth=this.lineWidth;for(var r=0;r<=o.MacroScene.ColNum;r++)n=r*o.MacroScene.HouseSize,a=n+t.y,a>=0&&a<=e.canvas.height&&(e.moveTo(0,n),e.lineTo(o.MacroScene.RowNum*o.MacroScene.HouseSize,n));e.stroke()},e.prototype.drawCols=function(e,t){e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth;for(var n=0,a=0,r=0;r<=o.MacroScene.RowNum;r++)n=r*o.MacroScene.HouseSize,a=n+t.x,a>=0&&a<=e.canvas.width&&(e.moveTo(n,0),e.lineTo(n,o.MacroScene.ColNum*o.MacroScene.HouseSize));e.stroke()},e}();t.LandRender=a}}]);
//# sourceMappingURL=page-house-index.74d34adb.js.map