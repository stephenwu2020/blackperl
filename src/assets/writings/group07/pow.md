# Proof-of-Work

Proof-of-work, POW, 这个算法是发明 Bitcoin 的最重要的驱动力之一。最早出现于1992年的一篇论文中，用于防止垃圾邮件攻击。后来又被用来防止 DDoS 攻击。在这两方面都没有特别成功，如今却在加密货币中大显身手。

Bitcoin 的 POW 算法里，使用了 SHA-256 哈希方法。矿工重复地用 SHA-256 对 header 进行哈希，每次迭代，使用不同的 nonce 和时间戳填入 header 里，直到产生的哈希结果少于网络设置的难度值，然后把这个 block 广播到网络当中。矿工创造新的 block 消耗了大量的计算资源，存储资源，电力等等，为此，把随着该 block 诞生的新的比特币作为矿工的奖励，矿工可以在 block 里加入发送奖励到 coinbase 账户的 transaction，接收新创建的比特币奖励。

为了祢补 SHA-256 哈希方法的缺陷，人们设计了许多变种。最简单的 SHA-256，适合在 ASIC 硬件上运算和挖矿。Litecoin 使用 Scrypt，它被设计成运算效率与内存的大小相关，但是有特定 ASIC 专门针对它设计出来了。Monero 使用 CryptoNight，被设计成特殊的系统调用相关，在传统的 CPU 架构是最高效的。

Ethereum 使用的算法叫做 Ethash，被设计成最适合使用 GPU 运算。它的运行过程，需要反复读取内存里的有向循环图 DAG，DAG 大少超过1G，ASIC 的硬件通常只有很少的内存，难以运行。

在 POW 算法机制下，任何人想要控制整个网络系统，必须拥有51%以上 hashpower。Block 的奖励和 transaction 的小费吸引矿工挖矿，越多分散的矿工，那么进行51%攻击的难度就越大。网络的挖矿难度动态调整，目前 Ethereum 新的 block 诞生，一般在20秒左右。

Ethereum 的系统设置了一个难度炸弹，当系统到达难度炸弹的条件时，挖矿难度会相当高，新的 block 的诞生非常艰难，矿工将无利可图，整个系统将会走向瘫痪。之所以设置这个玩意，是督促 Ethereum 切换 POS 算法。估计在切换 POS 之后，挖矿的奖励将降低到接近0.
