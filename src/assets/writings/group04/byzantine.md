# 拜占庭将军问题

故事发生在中世纪黑暗时代，一艘海盗船正遭受围攻。海盗船上有200个海盗，被6搜军舰围堵，每艘军舰有50名士兵，由一位将军指挥。如果300名士兵同时攻击海盗，赢得战争轻而易举，否则，会被海盗逐一击破。

![img](/book/ships.jpg)

问题是，6位将军如何达成一致，作出决定呢？如果是今天，大家开个视频会议，决定晚上10点发起总攻，打完收工，还有时间吃顿宵夜。但在中世纪，情况有点复杂：

- 晚上10点攻击这个消息，只能派遣一位水手，找遍6位将军，一一确认，达成一致。
- 其中，有的将军可能是叛徒，暗地里与海盗勾结。

# 失败的策略
- 将军1决定晚上10点攻击，他派遣水手，将消息亲自传递给将军2
- 将军2读取了信息，同意晚上10点攻击，同时让水手继续把消息传递给将军3
- 将军3是叛徒，他看到消息后，把攻击时间修改为晚上9点，让水手继续把消息传递给将军4
- 将军4，5，6得到的消息是晚上9点攻击
- 晚上9点，将军4，5，6发起攻击，150士兵不敌200水手，攻击失败
- 晚上10点，将军1，2发起攻击，将军3叛变，加入海盗，结果海盗完胜

# 胜利的策略
将军1准备晚上10点发起攻击，他开始传递消息给其它将军，这一次，必须遵守以下两条规则：
- 将军的消息由特殊的机关保护，必须花10分钟才能将信息准备好
- 将军的消息，必须挂在其它将军的后面，一起发送，使得作出决定的将军的信息都能被后面的将军看到

在这种情况下，将军1花10分钟准备晚上10点攻击的消息，传递给将军2。将军2收到消息之后，能够确认两点:
- 需要花10分钟来创建我的消息
- 由于将军1的消息是第一条数据，它一定是真的。（即使不是真的，也不会影响战斗结果）

现在，将军2花了10分钟准备自己的消息，然后挂在将军1的消息下面，形成一条链条。水手把这一串消息传递给将军3

将军3是一个叛徒，上一次，他直接修改了信息，导致军队攻击失败，损失惨重。如今，在新的规则下，他有两种做法：

- 其一，花10分钟准备晚上9点攻击的假信息，然后，再各自花10分钟来篡改将军1和将军2的消息。这样，整条消息链全部改为了晚上9点攻击，但是将军花了30分钟来准备，其它将军不会认可这条消息的，也知道了他叛徒的身份。
- 其二，将军3挂上晚上10点攻击的消息。因为其它将军能够看到所有将军的消息，他不可能挂上不一致的数据。

换句话说，每个将军只有10分钟的时间，而准备自己的消息决定也至少10分钟，将军没有更多的时间去作假。任何超过10分钟的准备，都不会得到联盟的认可。
