# 达成共识

达成共识是指某些节点决定是否添加某个 block 到 blockchain 的过程。这个过程依赖一组共享的规则。网络上的所有节点必须在一组相互兼容的规则下行动。在部分 blockchain 里，这套规则又被称为 block 校验规则，因为节点根据它，决定是否把网络上接受的 block 加入到本地数据库，并且传播给邻居节点。

Ethereum 在 EVM 执行代码，更新 state tree 的 Merkle root 的过程中应用共识规则。每个节点有序地运行 block 里的 transaction，每个 transaction 在 EVM 的眼里是有序的指令。如果各个节点里，EVM 的运行规则是一样的，最终的结果都是相同的状态。

如果部分节点采取了不同的共识规则，就会导致 fork 分叉。如果新的规则是旧的规则的子集，导致的是 soft fork。这种情况下，矿工节点必须更新，新的规则创建的 block 仍被旧规则节点接受。反之则不然。

如果新规则不是旧规则的子集，两者不兼容，导致的是 hark fork。所有节点都必须更新。没有更新的节点，不能得到更新的节点的认可。ETC 的诞生，就是由于部分节点不愿意更新，不愿意调解 DAO 攻击导致的后果，此后就独立发展了。
